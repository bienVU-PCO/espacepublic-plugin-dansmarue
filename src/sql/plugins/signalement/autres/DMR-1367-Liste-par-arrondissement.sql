-- 10 premiers signaleurs par arrondissement - signaleurs non agent  --
select '1er' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=1 group by  mail order by nb_signalement desc limit 10;
select '2ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=2 group by  mail order by nb_signalement desc limit 10;
select '3ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=3 group by  mail order by nb_signalement desc limit 10;
select '4ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=4 group by  mail order by nb_signalement desc limit 10;
select '5ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=5 group by  mail order by nb_signalement desc limit 10;
select '6ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=6 group by  mail order by nb_signalement desc limit 10;
select '7ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=7 group by  mail order by nb_signalement desc limit 10;
select '8ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=8 group by  mail order by nb_signalement desc limit 10;
select '9ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=9 group by  mail order by nb_signalement desc limit 10;
select '10ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=10 group by  mail order by nb_signalement desc limit 10;
select '11ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=11 group by  mail order by nb_signalement desc limit 10;
select '12ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=12 group by  mail order by nb_signalement desc limit 10;
select '13ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=13 group by  mail order by nb_signalement desc limit 10;
select '14ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=14 group by  mail order by nb_signalement desc limit 10;
select '15ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=15 group by  mail order by nb_signalement desc limit 10;
select '16ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=16 group by  mail order by nb_signalement desc limit 10;
select '17ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=17 group by  mail order by nb_signalement desc limit 10;
select '18ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=18 group by  mail order by nb_signalement desc limit 10;
select '19ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=19 group by  mail order by nb_signalement desc limit 10;
select '20ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail not like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=20 group by  mail order by nb_signalement desc limit 10;

--  10 premiers signaleurs par arrondissement - signaleurs agent  --
select '1er' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=1 group by  mail order by nb_signalement desc limit 10;
select '2ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=2 group by  mail order by nb_signalement desc limit 10;
select '3ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=3 group by  mail order by nb_signalement desc limit 10;
select '4ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=4 group by  mail order by nb_signalement desc limit 10;
select '5ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=5 group by  mail order by nb_signalement desc limit 10;
select '6ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=6 group by  mail order by nb_signalement desc limit 10;
select '7ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=7 group by  mail order by nb_signalement desc limit 10;
select '8ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=8 group by  mail order by nb_signalement desc limit 10;
select '9ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=9 group by  mail order by nb_signalement desc limit 10;
select '10ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=10 group by  mail order by nb_signalement desc limit 10;
select '11ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=11 group by  mail order by nb_signalement desc limit 10;
select '12ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=12 group by  mail order by nb_signalement desc limit 10;
select '13ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=13 group by  mail order by nb_signalement desc limit 10;
select '14ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=14 group by  mail order by nb_signalement desc limit 10;
select '15ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=15 group by  mail order by nb_signalement desc limit 10;
select '16ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=16 group by  mail order by nb_signalement desc limit 10;
select '17ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=17 group by  mail order by nb_signalement desc limit 10;
select '18ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=18 group by  mail order by nb_signalement desc limit 10;
select '19ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=19 group by  mail order by nb_signalement desc limit 10;
select '20ème' arrondissement , count(id_signaleur) nb_signalement, mail from signalement_signaleur signaleur join signalement_signalement signalement on signaleur.fk_id_signalement = signalement.id_signalement where mail is not null and mail <>'' and mail  like '%@paris.fr' and signalement.annee = 2018 and fk_id_arrondissement=20 group by  mail order by nb_signalement desc limit 10;